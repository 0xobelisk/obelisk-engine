{"version":3,"file":"meshopt_decoder.wasm.js.js","sources":["../../../../../../../native/external/emscripten/meshopt/meshopt_decoder.wasm.js"],"sourcesContent":["// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2023, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptDecoder = (function() {\n\t\"use strict\";\n\n\tvar instance;\n\tvar supported = false;\n\n\tvar ready = (instantiateWasm = {}) => {\n\n\t\tif (typeof instantiateWasm !== 'function') {\n\t\t\treturn Promise.reject(new Error('No wasm support detected'));\n\t\t}\n\n\t\treturn instantiateWasm().then(function(result) {\n\t\t\tsupported = true;\n\t\t\tinstance = result.instance;\n\t\t\tinstance.exports.__wasm_call_ctors();\n\t\t});\n\t}\n\n\tfunction decode(fun, target, count, size, source, filter) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar count4 = (count + 3) & ~3;\n\t\tvar tp = sbrk(count4 * size);\n\t\tvar sp = sbrk(source.length);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(source, sp);\n\t\tvar res = fun(tp, count, size, sp, source.length);\n\t\tif (res == 0 && filter) {\n\t\t\tfilter(tp, count4, size);\n\t\t}\n\t\ttarget.set(heap.subarray(tp, tp + count * size));\n\t\tsbrk(tp - sbrk(0));\n\t\tif (res != 0) {\n\t\t\tthrow new Error(\"Malformed buffer data: \" + res);\n\t\t}\n\t}\n\n\tvar filters = {\n\t\tNONE: \"\",\n\t\tOCTAHEDRAL: \"meshopt_decodeFilterOct\",\n\t\tQUATERNION: \"meshopt_decodeFilterQuat\",\n\t\tEXPONENTIAL: \"meshopt_decodeFilterExp\",\n\t};\n\n\tvar decoders = {\n\t\tATTRIBUTES: \"meshopt_decodeVertexBuffer\",\n\t\tTRIANGLES: \"meshopt_decodeIndexBuffer\",\n\t\tINDICES: \"meshopt_decodeIndexSequence\",\n\t};\n\n\tvar workers = [];\n\tvar requestId = 0;\n\n\tfunction createWorker(url) {\n\t\tvar worker = {\n\t\t\tobject: new Worker(url),\n\t\t\tpending: 0,\n\t\t\trequests: {}\n\t\t};\n\n\t\tworker.object.onmessage = function(event) {\n\t\t\tvar data = event.data;\n\n\t\t\tworker.pending -= data.count;\n\t\t\tworker.requests[data.id][data.action](data.value);\n\n\t\t\tdelete worker.requests[data.id];\n\t\t};\n\n\t\treturn worker;\n\t}\n\n\tfunction initWorkers(count) {\n\t\tvar source =\n\t\t\t\"var instance; var ready = WebAssembly.instantiate(new Uint8Array([\" + new Uint8Array(unpack(wasm)) + \"]), {})\" +\n\t\t\t\".then(function(result) { instance = result.instance; instance.exports.__wasm_call_ctors(); });\" +\n\t\t\t\"self.onmessage = workerProcess;\" +\n\t\t\tdecode.toString() + workerProcess.toString();\n\n\t\tvar blob = new Blob([source], {type: 'text/javascript'});\n\t\tvar url = URL.createObjectURL(blob);\n\n\t\tfor (var i = 0; i < count; ++i) {\n\t\t\tworkers[i] = createWorker(url);\n\t\t}\n\n\t\tURL.revokeObjectURL(url);\n\t}\n\n\tfunction decodeWorker(count, size, source, mode, filter) {\n\t\tvar worker = workers[0];\n\n\t\tfor (var i = 1; i < workers.length; ++i) {\n\t\t\tif (workers[i].pending < worker.pending) {\n\t\t\t\tworker = workers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar data = new Uint8Array(source);\n\t\t\tvar id = requestId++;\n\n\t\t\tworker.pending += count;\n\t\t\tworker.requests[id] = { resolve: resolve, reject: reject };\n\t\t\tworker.object.postMessage({ id: id, count: count, size: size, source: data, mode: mode, filter: filter }, [ data.buffer ]);\n\t\t});\n\t}\n\n\tfunction workerProcess(event) {\n\t\tready.then(function() {\n\t\t\tvar data = event.data;\n\t\t\ttry {\n\t\t\t\tvar target = new Uint8Array(data.count * data.size);\n\t\t\t\tdecode(instance.exports[data.mode], target, data.count, data.size, data.source, instance.exports[data.filter]);\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: \"resolve\", value: target }, [ target.buffer ]);\n\t\t\t} catch (error) {\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: \"reject\", value: error });\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: supported,\n\t\tuseWorkers: function(count) {\n\t\t\tinitWorkers(count);\n\t\t},\n\t\tdecodeVertexBuffer: function(target, count, size, source, filter) {\n\t\t\tdecode(instance.exports.meshopt_decodeVertexBuffer, target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeIndexBuffer: function(target, count, size, source) {\n\t\t\tdecode(instance.exports.meshopt_decodeIndexBuffer, target, count, size, source);\n\t\t},\n\t\tdecodeIndexSequence: function(target, count, size, source) {\n\t\t\tdecode(instance.exports.meshopt_decodeIndexSequence, target, count, size, source);\n\t\t},\n\t\tdecodeGltfBuffer: function(target, count, size, source, mode, filter) {\n\t\t\tdecode(instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeGltfBufferAsync: function(count, size, source, mode, filter) {\n\t\t\tif (workers.length > 0) {\n\t\t\t\treturn decodeWorker(count, size, source, decoders[mode], filters[filter]);\n\t\t\t}\n\n\t\t\treturn ready.then(function() {\n\t\t\t\tvar target = new Uint8Array(count * size);\n\t\t\t\tdecode(instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t\t\treturn target;\n\t\t\t});\n\t\t}\n\t};\n})();\n\nexport default MeshoptDecoder;"],"names":[],"mappings":";;;;;GAAA;GACA;AACG,OAAC,cAAc,sBAAG,CAAC,WAAW;AAEjC;GACA,CAAC,IAAI,QAAQ,CAAC;GACd,CAAC,IAAI,SAAS,GAAG,KAAK,CAAC;AACvB;GACA,CAAC,IAAI,KAAK,GAAG,CAAC,eAAe,GAAG,EAAE,KAAK;AACvC;GACA,EAAE,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;GAC7C,GAAG,OAAO,OAAO,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,0BAA0B,CAAC,CAAC,CAAC;GAChE,GAAG;AACH;GACA,EAAE,OAAO,eAAe,EAAE,CAAC,IAAI,CAAC,SAAS,MAAM,EAAE;GACjD,GAAG,SAAS,GAAG,IAAI,CAAC;GACpB,GAAG,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;GAC9B,GAAG,QAAQ,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAAC;GACxC,GAAG,CAAC,CAAC;GACL,GAAE;AACF;GACA,CAAC,SAAS,MAAM,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE;GAC3D,EAAE,IAAI,IAAI,GAAG,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC;GACnC,EAAE,IAAI,MAAM,GAAG,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;GAChC,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC;GAC/B,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;GAC/B,EAAE,IAAI,IAAI,GAAG,IAAI,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;GAC5D,EAAE,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;GACvB,EAAE,IAAI,GAAG,GAAG,GAAG,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC;GACpD,EAAE,IAAI,GAAG,IAAI,CAAC,IAAI,MAAM,EAAE;GAC1B,GAAG,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;GAC5B,GAAG;GACH,EAAE,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC;GACnD,EAAE,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;GACrB,EAAE,IAAI,GAAG,IAAI,CAAC,EAAE;GAChB,GAAG,MAAM,IAAI,KAAK,CAAC,yBAAyB,GAAG,GAAG,CAAC,CAAC;GACpD,GAAG;GACH,EAAE;AACF;GACA,CAAC,IAAI,OAAO,GAAG;GACf,EAAE,IAAI,EAAE,EAAE;GACV,EAAE,UAAU,EAAE,yBAAyB;GACvC,EAAE,UAAU,EAAE,0BAA0B;GACxC,EAAE,WAAW,EAAE,yBAAyB;GACxC,EAAE,CAAC;AACH;GACA,CAAC,IAAI,QAAQ,GAAG;GAChB,EAAE,UAAU,EAAE,4BAA4B;GAC1C,EAAE,SAAS,EAAE,2BAA2B;GACxC,EAAE,OAAO,EAAE,6BAA6B;GACxC,EAAE,CAAC;AACH;GACA,CAAC,IAAI,OAAO,GAAG,EAAE,CAAC;GAClB,CAAC,IAAI,SAAS,GAAG,CAAC,CAAC;AACnB;GACA,CAAC,SAAS,YAAY,CAAC,GAAG,EAAE;GAC5B,EAAE,IAAI,MAAM,GAAG;GACf,GAAG,MAAM,EAAE,IAAI,MAAM,CAAC,GAAG,CAAC;GAC1B,GAAG,OAAO,EAAE,CAAC;GACb,GAAG,QAAQ,EAAE,EAAE;GACf,GAAG,CAAC;AACJ;GACA,EAAE,MAAM,CAAC,MAAM,CAAC,SAAS,GAAG,SAAS,KAAK,EAAE;GAC5C,GAAG,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;AACzB;GACA,GAAG,MAAM,CAAC,OAAO,IAAI,IAAI,CAAC,KAAK,CAAC;GAChC,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;AACrD;GACA,GAAG,OAAO,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;GACnC,GAAG,CAAC;AACJ;GACA,EAAE,OAAO,MAAM,CAAC;GAChB,EAAE;AACF;GACA,CAAC,SAAS,WAAW,CAAC,KAAK,EAAE;GAC7B,EAAE,IAAI,MAAM;GACZ,GAAG,oEAAoE,GAAG,IAAI,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,GAAG,SAAS;GAClH,GAAG,gGAAgG;GACnG,GAAG,iCAAiC;GACpC,GAAG,MAAM,CAAC,QAAQ,EAAE,GAAG,aAAa,CAAC,QAAQ,EAAE,CAAC;AAChD;GACA,EAAE,IAAI,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,EAAE,iBAAiB,CAAC,CAAC,CAAC;GAC3D,EAAE,IAAI,GAAG,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;AACtC;GACA,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,EAAE,CAAC,EAAE;GAClC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,YAAY,CAAC,GAAG,CAAC,CAAC;GAClC,GAAG;AACH;GACA,EAAE,GAAG,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;GAC3B,EAAE;AACF;GACA,CAAC,SAAS,YAAY,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE;GAC1D,EAAE,IAAI,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;AAC1B;GACA,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;GAC3C,GAAG,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,MAAM,CAAC,OAAO,EAAE;GAC5C,IAAI,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;GACxB,IAAI;GACJ,GAAG;AACH;GACA,EAAE,OAAO,IAAI,OAAO,CAAC,UAAU,OAAO,EAAE,MAAM,EAAE;GAChD,GAAG,IAAI,IAAI,GAAG,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC;GACrC,GAAG,IAAI,EAAE,GAAG,SAAS,EAAE,CAAC;AACxB;GACA,GAAG,MAAM,CAAC,OAAO,IAAI,KAAK,CAAC;GAC3B,GAAG,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC;GAC9D,GAAG,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;GAC9H,GAAG,CAAC,CAAC;GACL,EAAE;AACF;GACA,CAAC,SAAS,aAAa,CAAC,KAAK,EAAE;GAC/B,EAAE,KAAK,CAAC,IAAI,CAAC,WAAW;GACxB,GAAG,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;GACzB,GAAG,IAAI;GACP,IAAI,IAAI,MAAM,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;GACxD,IAAI,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;GACnH,IAAI,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC;GAC9G,IAAI,CAAC,OAAO,KAAK,EAAE;GACnB,IAAI,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;GACzF,IAAI;GACJ,GAAG,CAAC,CAAC;GACL,EAAE;AACF;GACA,CAAC,OAAO;GACR,EAAE,KAAK,EAAE,KAAK;GACd,EAAE,SAAS,EAAE,SAAS;GACtB,EAAE,UAAU,EAAE,SAAS,KAAK,EAAE;GAC9B,GAAG,WAAW,CAAC,KAAK,CAAC,CAAC;GACtB,GAAG;GACH,EAAE,kBAAkB,EAAE,SAAS,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE;GACpE,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,0BAA0B,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;GACvH,GAAG;GACH,EAAE,iBAAiB,EAAE,SAAS,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE;GAC3D,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,yBAAyB,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;GACnF,GAAG;GACH,EAAE,mBAAmB,EAAE,SAAS,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE;GAC7D,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,2BAA2B,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;GACrF,GAAG;GACH,EAAE,gBAAgB,EAAE,SAAS,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE;GACxE,GAAG,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;GAC5G,GAAG;GACH,EAAE,qBAAqB,EAAE,SAAS,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE;GACrE,GAAG,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;GAC3B,IAAI,OAAO,YAAY,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;GAC9E,IAAI;AACJ;GACA,GAAG,OAAO,KAAK,CAAC,IAAI,CAAC,WAAW;GAChC,IAAI,IAAI,MAAM,GAAG,IAAI,UAAU,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC;GAC9C,IAAI,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;GAC7G,IAAI,OAAO,MAAM,CAAC;GAClB,IAAI,CAAC,CAAC;GACN,GAAG;GACH,EAAE,CAAC;GACH,CAAC;;;;;;"}