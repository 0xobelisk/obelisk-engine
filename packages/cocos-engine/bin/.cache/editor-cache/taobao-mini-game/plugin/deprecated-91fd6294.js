System.register(["./index-433d8403.js","./pipeline-state-manager-c8832894.js","./buffer-barrier-8663498b.js","./node-event-0336ef70.js","./director-c293a59c.js","./camera-component-67be14d4.js","./model-renderer-0476c968.js","./renderer-8d761016.js"],(function(e){"use strict";var n,r,t,a,i,o,s,d,u,c,l,m,f,b,v,h,x,g,p,I,M;return{setters:[function(e){n=e.cr,r=e.cs,t=e.bB,a=e.t,i=e.c7,o=e.o,s=e.bF,d=e.bI,u=e.bE,c=e.bX,l=e.bj,m=e.aj,f=e.al,b=e.l,v=e.ct},function(){},function(e){h=e.v},function(e){x=e.C},function(e){g=e.aB},function(e){p=e.C},function(e){I=e.M},function(e){M=e.R}],execute:function(){function S(e,n,r){var t=e.o,a=e.d,i=1/a.x,o=1/a.y,s=1/a.z,d=(n.x-t.x)*i,u=(r.x-t.x)*i,c=(n.y-t.y)*o,l=(r.y-t.y)*o,m=(n.z-t.z)*s,f=(r.z-t.z)*s,b=Math.max(Math.max(Math.min(d,u),Math.min(c,l)),Math.min(m,f)),v=Math.min(Math.min(Math.max(d,u),Math.max(c,l)),Math.max(m,f));return v<0||b>v?0:b>0?b:v}var y,C,N,A,T,j,L,E,w,R=(y=n.create(),C={distance:1/0,doubleSided:!1,mode:r.ANY},N=0,A=function(e,n,t,a,i,o){e===r.CLOSEST?(N>n||0===N)&&(N=n,o&&(0===o.length?o.push({distance:n,vertexIndex0:t/3,vertexIndex1:a/3,vertexIndex2:i/3}):(o[0].distance=n,o[0].vertexIndex0=t/3,o[0].vertexIndex1=a/3,o[0].vertexIndex2=i/3))):(N=n,o&&o.push({distance:n,vertexIndex0:t/3,vertexIndex1:a/3,vertexIndex2:i/3}))},function(e,n,t){if(N=0,0===n.geometricInfo.positions.length)return N;var a=void 0===t?C:t;if(S(e,n.geometricInfo.boundingBox.min,n.geometricInfo.boundingBox.max)){var s=n.primitiveMode,d=n.geometricInfo;!function(e,n,t,a,s){if(t===h.TRIANGLE_LIST)for(var d=n.length,u=0;u<d;u+=3){var c=3*n[u],l=3*n[u+1],m=3*n[u+2];o.set(y.a,e[c],e[c+1],e[c+2]),o.set(y.b,e[l],e[l+1],e[l+2]),o.set(y.c,e[m],e[m+1],e[m+2]);var f=i.rayTriangle(a,y,s.doubleSided);if(!(0===f||f>s.distance)&&(A(s.mode,f,c,l,m,s.result),s.mode===r.ANY))return f}else if(t===h.TRIANGLE_STRIP)for(var b=n.length-2,v=0,x=0;x<b;x+=1){var g=3*n[x-v],p=3*n[x+v+1],I=3*n[x+2];o.set(y.a,e[g],e[g+1],e[g+2]),o.set(y.b,e[p],e[p+1],e[p+2]),o.set(y.c,e[I],e[I+1],e[I+2]),v=~v;var M=i.rayTriangle(a,y,s.doubleSided);if(!(0===M||M>s.distance)&&(A(s.mode,M,g,p,I,s.result),s.mode===r.ANY))return M}else if(t===h.TRIANGLE_FAN){var S=n.length-1,C=3*n[0];o.set(y.a,e[C],e[C+1],e[C+2]);for(var N=1;N<S;N+=1){var T=3*n[N],j=3*n[N+1];o.set(y.b,e[T],e[T+1],e[T+2]),o.set(y.c,e[j],e[j+1],e[j+2]);var L=i.rayTriangle(a,y,s.doubleSided);if(!(0===L||L>s.distance)&&(A(s.mode,L,C,T,j,s.result),s.mode===r.ANY))return L}}}(d.positions,d.indices,s,e,a)}return N}),Y=function(){var e=0,n={distance:1/0,doubleSided:!1,mode:r.ANY};return function(t,a,i){e=0;var o=void 0===i?n:i,s=a.renderingSubMeshes.length,d=a.struct.minPosition,u=a.struct.maxPosition;if(d&&u&&!S(t,d,u))return e;for(var c=0;c<s;c++){var l=a.renderingSubMeshes[c],m=R(t,l,o);if(m)if(o.mode===r.CLOSEST)(0===e||e>m)&&(e=m,o.subIndices&&(o.subIndices[0]=c));else if(e=m,o.subIndices&&o.subIndices.push(c),o.mode===r.ANY)return m}return e&&o.mode===r.CLOSEST&&(o.result&&(o.result[0].distance=e,o.result.length=1),o.subIndices&&(o.subIndices.length=1)),e}}(),B=function(){var e=0,n={distance:1/0,doubleSided:!1,mode:r.ANY},s=new t,d=new a;return function(u,c,l){e=0;var m=void 0===l?n:l,f=c.worldBounds;if(f&&!i.rayAABB(u,f))return e;t.copy(s,u),c.node&&(a.invert(d,c.node.getWorldMatrix(d)),o.transformMat4(s.o,u.o,d),o.transformMat4Normal(s.d,u.d,d));for(var b=c.subModels,v=0;v<b.length;v++){var h=b[v].subMesh,x=R(s,h,m);if(x)if(m.mode===r.CLOSEST)(0===e||e>x)&&(e=x,m.subIndices&&(m.subIndices[0]=v));else if(e=x,m.subIndices&&m.subIndices.push(v),m.mode===r.ANY)return x}return e&&m.mode===r.CLOSEST&&(m.result&&(m.result[0].distance=e,m.result.length=1),m.subIndices&&(m.subIndices.length=1)),e}}();i.rayModel=B,i.raySubMesh=R,i.rayMesh=Y;var z=l,O=c;e("P",(T=u("cc.PrefabLink"),j=O(g),T((E=function(e){function n(){for(var n,r=arguments.length,t=new Array(r),a=0;a<r;a++)t[a]=arguments[a];return(n=e.call.apply(e,[this].concat(t))||this).prefab=w&&w(),n}return s(n,e),n}(x),w=d(E.prototype,"prefab",[j,z],(function(){return null})),L=E))||L)),m(p,"Camera",[{name:"CameraClearFlag",newName:"ClearFlag"}]),m(p.prototype,"Camera.prototype",[{name:"color",newName:"clearColor"},{name:"depth",newName:"clearDepth"},{name:"stencil",newName:"clearStencil"}]),f(M.prototype,"Renderer.prototype",[{name:"getMaterial",suggest:"please use renderer.getSharedMaterial instead."}]),b.CameraComponent=p,v(p,"cc.CameraComponent"),b.RenderableComponent=I,v(I,"cc.RenderableComponent")}}}));
